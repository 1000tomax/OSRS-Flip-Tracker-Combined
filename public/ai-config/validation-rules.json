{
  "rules": {
    "queryLength": {
      "min": 2,
      "max": 500,
      "errorMessage": "Query must be between 2 and 500 characters"
    },
    "timeRange": {
      "maxDays": 365,
      "validPresets": ["last_7d", "last_30d", "this_week", "this_month", "last_month", "all_time"],
      "errorMessage": "Time range cannot exceed 365 days"
    },
    "limits": {
      "max": 1000,
      "default": 50,
      "errorMessage": "Result limit cannot exceed 1000 rows"
    },
    "requiredFields": {
      "profit_queries": ["buy_price", "sell_price"],
      "roi_queries": ["buy_price", "sell_price"],
      "volume_queries": ["buy_price", "quantity"],
      "errorMessage": "Required data fields are missing for this calculation"
    },
    "confidence": {
      "minThreshold": 0.6,
      "clarificationThreshold": 0.4,
      "errorMessage": "Query intent unclear, please rephrase"
    },
    "sqlSafety": {
      "forbiddenKeywords": [
        "CREATE",
        "DROP",
        "ALTER",
        "INSERT",
        "UPDATE",
        "DELETE",
        "PRAGMA",
        "ATTACH",
        "DETACH",
        "VACUUM",
        "REINDEX"
      ],
      "allowedKeywords": [
        "SELECT",
        "FROM",
        "WHERE",
        "GROUP",
        "ORDER",
        "HAVING",
        "LIMIT",
        "JOIN",
        "UNION",
        "WITH",
        "CASE",
        "WHEN"
      ],
      "maxComplexity": 5,
      "errorMessage": "Query contains unsafe SQL operations"
    }
  },
  "itemValidation": {
    "minimumConfidence": 0.5,
    "maxSuggestions": 5,
    "fuzzyMatchThreshold": 0.7,
    "requiredForItemQueries": true,
    "errorMessage": "Item not found or ambiguous, please specify more clearly"
  },
  "temporalValidation": {
    "dateFormats": ["YYYY-MM-DD", "YYYY-MM", "MM-DD"],
    "relativeDates": {
      "today": "date('now')",
      "yesterday": "date('now', '-1 day')",
      "last_week": "date('now', '-7 days')",
      "last_month": "date('now', '-1 month')"
    },
    "dayOfWeekValidation": {
      "validValues": ["0", "1", "2", "3", "4", "5", "6"],
      "mappings": {
        "sunday": "0",
        "monday": "1",
        "tuesday": "2",
        "wednesday": "3",
        "thursday": "4",
        "friday": "5",
        "saturday": "6"
      }
    },
    "errorMessage": "Invalid date or time period specified"
  },
  "metricValidation": {
    "validMetrics": ["profit", "roi", "flips", "*", "volume", "avg_hold_time"],
    "validOperations": ["sum", "avg", "count", "min", "max"],
    "metricConstraints": {
      "roi": {
        "maxValue": 10000,
        "minValue": -100,
        "description": "ROI percentage should be reasonable"
      },
      "profit": {
        "maxValue": 2147483647,
        "minValue": -2147483647,
        "description": "Profit in GP"
      }
    },
    "errorMessage": "Invalid metric or operation specified"
  },
  "dimensionValidation": {
    "validDimensions": ["item", "date", "account", "hour", "weekday"],
    "maxDimensions": 3,
    "requiredCombinations": {
      "time_analysis": ["date"],
      "item_analysis": ["item"],
      "account_analysis": ["account"]
    },
    "errorMessage": "Invalid grouping dimensions specified"
  },
  "filterValidation": {
    "validOperators": ["=", "!=", ">", ">=", "<", "<=", "in", "contains", "between"],
    "maxFilters": 10,
    "filterTypes": {
      "numeric": ["profit", "roi", "buy_price", "sell_price", "quantity", "flip_duration_minutes"],
      "text": ["item", "account"],
      "date": ["date", "buy_time", "sell_time"]
    },
    "errorMessage": "Invalid filter conditions specified"
  },
  "impossibleQueries": [
    {
      "patterns": ["live", "real-time", "current", "now"],
      "context": ["price", "market", "ge"],
      "reason": "Live market data not available",
      "suggestions": ["Recent completed flips", "Historical price trends"]
    },
    {
      "patterns": ["predict", "forecast", "will", "future"],
      "reason": "Prediction capabilities not available",
      "suggestions": ["Historical analysis", "Trend analysis", "Past performance"]
    },
    {
      "patterns": ["other players", "everyone", "server", "global"],
      "reason": "Only personal data available",
      "suggestions": ["Your account performance", "Your flip history"]
    },
    {
      "patterns": ["pending", "active", "offers"],
      "reason": "Only completed flips are tracked",
      "suggestions": ["Completed flips", "Recent sales", "Flip history"]
    }
  ],
  "clarificationTriggers": [
    {
      "condition": "multiple_time_ranges",
      "question": "Which time period would you like to analyze?",
      "options": ["Last 7 days", "Last 30 days", "This month", "All time"]
    },
    {
      "condition": "ambiguous_item",
      "question": "Which item are you referring to?",
      "dynamicOptions": true
    },
    {
      "condition": "multiple_metrics",
      "question": "What metric are you most interested in?",
      "options": ["Total profit", "ROI percentage", "Number of flips", "Average hold time"]
    },
    {
      "condition": "unclear_comparison",
      "question": "What would you like to compare?",
      "options": ["Time periods", "Items", "Accounts", "Performance metrics"]
    }
  ],
  "errorRecovery": {
    "typoCorrection": {
      "enabled": true,
      "maxEditDistance": 2,
      "suggestionCount": 3
    },
    "fallbackBehavior": {
      "onValidationFailure": "clarify",
      "onLowConfidence": "suggest_alternatives",
      "onImpossibleQuery": "explain_limitations",
      "onParsingError": "request_simplification"
    },
    "helpfulSuggestions": {
      "whenStuck": [
        "Try asking about specific items (e.g., 'dragon bolt profits')",
        "Specify a time period (e.g., 'last week' or 'this month')",
        "Ask for top results (e.g., 'top 10 most profitable items')",
        "Compare things (e.g., 'weekend vs weekday profits')"
      ]
    }
  }
}
